<!-- Existe alguma mensagem de erro de sistema? -->
<% if(budget.errors.any?) %>
  <div class="messages alert alert-warning" role="alert">
    <p><%= t('verify_the_following_errors') %>:</p>
    <ul>
      <% budget.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<div class="budget__form">
  <div class="orders__budget">
    <h3><%= t('select_desired_mode') %></h3>
    <% if @modes_prices_deadlines.empty? %>
      <h5><%= t('no_mode_can_attend_this_order') %></h5>
    <% else %>
      <table class="container table table-success table-striped">
        <thead>
          <tr>
            <th><%= t('name') %></th>
            <th><%= t('price') %></th>
            <th><%= t('deadline') %></th>
            <th><%= t('action') %></th>
          </tr>
        </thead>
        <tbody>
          <% @modes_prices_deadlines.each do |mode| %>
            <%= form_with(model: [@order, @budget], local: true) do |f| %>
              <% @total_price = '%.2f' % ((mode.price_per_km * @order.distance) + mode.fixed_fee) %>
              <tr>
                <td class="table__td-width"><%= mode.name %></td>
                <td class="table__td-width"><%= t('$') %> <%= @total_price %></td>
                <td class="table__td-width"><%= mode.deadline %> dias</td>
                <td>
                  <div class="orders__btn-budget">
                    <%= f.hidden_field :mode, value: mode.id %>
                    <%= f.hidden_field :total, value: @total_price %>
                    <%= f.hidden_field :price_km, value: mode.price_per_km %>
                    <%= f.hidden_field :fixed_fee, value: mode.fixed_fee %>
                    <%= f.hidden_field :deadline, value: mode.deadline %>
                    <%= f.hidden_field :order_id, value: @order.id %>
                    <%= f.submit t('select_mode'), class: "btn btn-success", disabled: (@modes_prices_deadlines.empty? ? true : false) %>
                  </div>
                </td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>